### 总结

2024.1.10-2025.1.16

### 主要进度：

1.构建材质图，为场景粒子添加水材质。添加天空盒代码，添加阴影

2.学习论文 A Survey on SPH Methods in Computer Graphics

效果图：

![3](.\3.png)

论文学习的数学公式： 

非压力预测速度： 

$ v^* = v(t) + \Delta t a^{nonp}(t) $

同时，由连续性方程$ \Delta (\rho u) + {\partial \rho \over \partial t} = 0$ 可知：

$ {\rho}^* = \rho(t)-\Delta t \rho(t)\nabla v^* $ 

 离散化有： 

$ {D\rho \over Dt} = {\rho^0 - \rho^* \over \Delta t}$

引入压力场： 

$ a^p = {1\over \rho} \nabla p(t)$

对离散时间单位有： 

$ v^p = -{1\over\rho}\nabla p(t)\Delta t$

对压力场由连续性方程可知： 

$ {\rho^0 - \rho* \over \Delta t} = {Dp\over Dt} = -\nabla \rho v^p = \nabla^2p(t)\Delta t$



#### Relaxed Jacobi:

对于$ Ap = s$

可用迭代法求解： 
$$
p_i^{l+1} = p_i^l + \alpha_i {s_i - (Ap^l)_i \over a_{ii}} \\
while \ \ \alpha_i \ \ is \ user \ defined \\
For\ IISPH \ is\ usually\ 0.5 
$$


#### IISPH 

$ \Delta t^2 \nabla^2pi  = \rho^0 - {\rho_i - \Delta t \rho_i\nabla v_i^*}$

采用两轮循环：

loop1：
$$
(a_i^p)^l = -{1\over\rho_i}\nabla p_i^l = -\sum m_j({p_i^l \over \rho_i^2} + {p_j^l \over \rho_j^2})\nabla W_{ij}
$$
 loop2:由
$$
{D\rho \over Dt} =\sum m_j(v_i-v_j)\nabla W_{ij}
$$
可知：
$$
\Delta \rho_i^l = \Delta t\sum m_j(\Delta t (a_i^p)^l - \Delta t (a_j^p)^l)\nabla W_{ij} \\ 
左侧=\rho_0-\rho_i^*
右侧=\Delta t^2\sum m_j((a_i^p)^l - (a_j^p)^l)\nabla W_{ij} 
$$
看成$s_i = Ap_i$形式，采用Relaxed Jacobi求解